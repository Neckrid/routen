<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fraktionen</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

<style>
body{
 margin:0;
 font-family:Arial, sans-serif;
 background: radial-gradient(circle at 30% 30%, #111 0%, #0a0a0a 40%, #000 100%);
 color:white;
 padding:40px;
 display:flex;
 gap:30px;
}

/* ===============================
   FRAKTION CARD
================================*/
.faction{
 width:320px;
 padding:20px;
 border-radius:22px;
 backdrop-filter: blur(18px) saturate(180%);
 -webkit-backdrop-filter: blur(18px) saturate(180%);
 background: rgba(255,255,255,0.05);
 border:1px solid rgba(255,255,255,0.1);
 box-shadow: 0 10px 40px rgba(0,0,0,0.5);
 display:flex;
 flex-direction:column;
 gap:15px;
}

.faction h2{
 margin:0;
 font-size:20px;
}

/* ===============================
   MITGLIEDER
================================*/
.member{
 padding:10px 14px;
 border-radius:12px;
 background:rgba(255,255,255,0.05);
 cursor:grab;
 transition:0.2s ease;
}

.member:hover{
 background:rgba(255,255,255,0.1);
 transform:translateY(-2px);
}

/* ===============================
   BUTTON BASIS
================================*/
.action-row{
 display:flex;
 gap:10px;
 margin-top:10px;
}

.action-btn{
 flex:1;
 backdrop-filter: blur(12px) saturate(180%);
 -webkit-backdrop-filter: blur(12px) saturate(180%);
 background: rgba(255,255,255,0.05);
 border-radius:14px;
 padding:10px;
 display:flex;
 align-items:center;
 justify-content:center;
 gap:8px;
 font-weight:600;
 cursor:pointer;
 transition: all 0.25s ease;
 border:1px solid rgba(255,255,255,0.1);
}

/* ===============================
   GRÃœN â€“ MITGLIED
================================*/
.btn-add{
 color:#00ff9d;
 border:1px solid rgba(0,255,157,0.4);
 box-shadow:0 0 12px rgba(0,255,157,0.15);
}

.btn-add:hover{
 background: rgba(0,255,157,0.08);
 box-shadow:
 0 0 20px rgba(0,255,157,0.5),
 inset 0 0 10px rgba(0,255,157,0.3);
 transform: translateY(-2px);
}

/* ===============================
   ROT â€“ LÃ–SCHEN
================================*/
.btn-delete{
 color:#ff4d4d;
 border:1px solid rgba(255,77,77,0.4);
 box-shadow:0 0 12px rgba(255,77,77,0.15);
}

.btn-delete:hover{
 background: rgba(255,77,77,0.08);
 box-shadow:
 0 0 20px rgba(255,77,77,0.5),
 inset 0 0 10px rgba(255,77,77,0.3);
 transform: translateY(-2px);
}

/* Drag Styling */
.dragging{
 opacity:0.5;
 transform:rotate(3deg);
}
</style>
</head>
<body>

<!-- FRAKTION 1 -->
<div class="faction">
 <h2>Bogota</h2>

 <div class="member-list" id="bogota">
   <div class="member" data-id="1">Luis Diaz</div>
   <div class="member" data-id="2">Toni Diaz</div>
   <div class="member" data-id="3">Luca Fuentes</div>
   <div class="member" data-id="4">Liam Castano</div>
 </div>

 <div class="action-row">
   <div class="action-btn btn-add">+ Mitglied</div>
   <div class="action-btn btn-delete">ðŸ—‘ Fraktion lÃ¶schen</div>
 </div>
</div>

<!-- FRAKTION 2 -->
<div class="faction">
 <h2 style="color:#ff4d4d;">Pusha</h2>

 <div class="member-list" id="pusha"></div>

 <div class="action-row">
   <div class="action-btn btn-add">+ Mitglied</div>
   <div class="action-btn btn-delete">ðŸ—‘ Fraktion lÃ¶schen</div>
 </div>
</div>

<!-- FRAKTION 3 -->
<div class="faction">
 <h2 style="color:#00ff9d;">Grove</h2>

 <div class="member-list" id="grove"></div>

 <div class="action-row">
   <div class="action-btn btn-add">+ Mitglied</div>
   <div class="action-btn btn-delete">ðŸ—‘ Fraktion lÃ¶schen</div>
 </div>
</div>

<script>
/* ===============================
   SUPABASE SETUP
================================*/
const supabaseUrl = "https://lleldalugvgmgqekcolx.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxsZWxkYWx1Z3ZnbWdxZWtjb2x4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE3OTg4OTgsImV4cCI6MjA4NzM3NDg5OH0.CuiVJ9kWraso1tLEJ3D6V4IssYGVeWaLs2ygerVU5tc";
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

/* ===============================
   DRAG & DROP
================================*/
document.querySelectorAll(".member-list").forEach(list=>{
 new Sortable(list,{
   group:"shared",
   animation:200,
   ghostClass:"dragging",
   onEnd:saveOrder
 });
});

/* ===============================
   SAVE ORDER TO SUPABASE
================================*/
async function saveOrder(){
 document.querySelectorAll(".member-list").forEach(async(list)=>{
   const members=[...list.querySelectorAll(".member")];
   for(let i=0;i<members.length;i++){
     const id=members[i].dataset.id;
     if(!id) continue;
     await supabase
       .from("members")
       .update({position:i, faction:list.id})
       .eq("id",id);
   }
 });
}
</script>

</body>
</html>
